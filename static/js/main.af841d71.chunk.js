(this.webpackJsonpvileo=this.webpackJsonpvileo||[]).push([[0],{11:function(e){e.exports=JSON.parse('{"name":"vileo","version":"1.0.2","private":true,"dependencies":{"@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.3.2","@testing-library/user-event":"^7.1.2","@types/jest":"^24.0.0","@types/node":"^12.0.0","@types/react":"^16.9.0","@types/react-dom":"^16.9.0","node-sass":"^4.14.0","react":"^16.13.1","react-dom":"^16.13.1","react-scripts":"3.4.1","typescript":"~3.7.2","@types/dom-mediacapture-record":"^1.0.3"},"scripts":{"start":"react-scripts start","start-https":"set HTTPS=true&&react-scripts start","build":"react-scripts build","test":"CI=false react-scripts build","eject":"react-scripts eject"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"homepage":"."}')},13:function(e,t,n){e.exports=n(20)},18:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(6),o=n.n(c);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(18);var i,s=n(2);!function(e){e[e.Welcome=0]="Welcome",e[e.Configure=1]="Configure",e[e.RecordingProcess=2]="RecordingProcess",e[e.Finished=3]="Finished"}(i||(i={}));var l=n(1),u=n.n(l),d=n(3),m=n(12),v=function(e){return r.createElement("div",{className:"app-container-inner animated fadeIn faster "+e.className},r.createElement("header",{className:"no-select"},"Vileo"),r.createElement("h1",{className:"no-select"},e.title),e.children)},f=function(e){return r.createElement("button",{className:"btn no-select",onClick:e.onClick},e.icon&&r.createElement("i",{className:"material-icons"},e.icon),e.children)},p=n(8),g=n(9),b=n(10),h=function(){function e(){Object(g.a)(this,e)}return Object(b.a)(e,null,[{key:"getScreen",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(1,t),e.next=3,navigator.mediaDevices.getDisplayMedia({video:!0,audio:t});case 3:return n=e.sent,console.log(2),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getWebcam",value:function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!0,audio:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getOnlyAudio",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!1});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getDevices",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"mergeTracks",value:function(e,t){var n=t,r=e.getAudioTracks()[0];if(!r&&n[0]&&(r=n[0].getAudioTracks()[0],n=n.slice(1)),!r)return null;var a=new AudioContext,c=a.createMediaStreamDestination(),o=new MediaStream([r]);a.createMediaStreamSource(o).connect(c);var i,s=Object(p.a)(n);try{for(s.s();!(i=s.n()).done;){var l=i.value;a.createMediaStreamSource(l).connect(c)}}catch(d){s.e(d)}finally{s.f()}var u=new MediaStream;return u.addTrack(c.stream.getTracks()[0]),u}}]),e}(),E=function(e){var t=Object(r.useState)(!1),n=Object(s.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)(!1),i=Object(s.a)(o,2),l=i[0],m=i[1],v=Object(r.useState)(void 0),f=Object(s.a)(v,2),p=f[0],g=f[1];return r.createElement("div",{className:"select-container no-select "+(a&&"open")},r.createElement("select",null,null===p||void 0===p?void 0:p.map((function(e){return r.createElement("option",{key:e.id,value:e.value,selected:l===e.id},e.value)}))),r.createElement("div",{className:"label-container",onClick:Object(d.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=g,t.next=3,null===(n=e.getOptions)||void 0===n?void 0:n.call(e);case 3:if(t.t1=t.sent,t.t1){t.next=6;break}t.t1=e.options;case 6:t.t2=t.t1,(0,t.t0)(t.t2),c((function(e){return!e}));case 9:case"end":return t.stop()}}),t)})))},e.title,r.createElement("i",{className:"material-icons arrow"},"keyboard_arrow_down")),r.createElement("div",{className:"options-container"},r.createElement("ul",null,null===p||void 0===p?void 0:p.map((function(t){return r.createElement("li",{key:t.id,onClick:function(){var n;e.dontSelect||m(t.id),null===(n=e.onChange)||void 0===n||n.call(e,t.id),c(!1)}},t.icon&&r.createElement("i",{className:"material-icons"},t.icon),t.value)})))))},w=function(e){return o.a.createPortal(r.createElement("div",{className:"dialog animated fadeIn"},r.createElement("div",{className:"app-container-inner"},r.createElement("h1",{className:"no-select"},e.title),e.children)),document.getElementById("portal"))},k=function(e){var t=Object(r.useRef)(null),n=Object(r.useState)(void 0),a=Object(s.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)([]),l=Object(s.a)(i,2),p=l[0],g=l[1],b=Object(r.useState)([]),k=Object(s.a)(b,2),y=k[0],O=k[1],j=Object(r.useState)(!1),N=Object(s.a)(j,2),C=N[0],S=N[1],R=Object(r.useState)(!1),x=Object(s.a)(R,2),T=x[0],D=x[1],M=!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime),I=function(e){o(e),e.getVideoTracks()[0].addEventListener("ended",(function(){return o(void 0)}))};return Object(r.useEffect)((function(){c&&t.current&&(t.current.srcObject=c,t.current.volume=0,t.current.play())}),[c]),r.createElement(v,{title:"Configure Recording"},T&&r.createElement(w,{title:r.createElement(r.Fragment,null,r.createElement("img",{height:"32",width:"32",src:"https://unpkg.com/simple-icons@v2/icons/googlechrome.svg",style:{filter:"invert(1)"}}),"\xa0 Screen Sharing under Chrome")},r.createElement("p",null,"You will now be asked to share a screen for recording. You can select ",r.createElement("b",null,'"Share Audio"')," to additionally record audio from the recorded display. This allows you to record applications that play audio such as videos or conferences."),r.createElement("div",{className:"bottom-actions"},r.createElement(f,{icon:"arrow_back",onClick:function(){D(!1)}},"Go back"),r.createElement(f,{icon:"arrow_forward",onClick:function(){D(!1),h.getScreen(!0).then(I),S(!0)}},"Okay, Start Recording"))),c&&r.createElement("div",{className:"video-preview animated zoomIn"},r.createElement("p",null,"Recording not",r.createElement("br",null),"yet started"),r.createElement("video",{ref:t})),c?r.createElement("div",{className:"card animated zoomIn faster"},C&&r.createElement("h2",{className:"no-select"},r.createElement("i",{className:"material-icons"},"tv"),"Video Device"),!C&&r.createElement("h2",{className:"no-select"},r.createElement("i",{className:"material-icons"},"videocam"),"Video Device"),r.createElement("p",null,C?"Display device setup for recording":"Webcam setup for recording"),r.createElement("div",{className:"actions"},r.createElement(f,{icon:"delete",onClick:function(){return null===c||void 0===c||c.getTracks().forEach((function(e){return e.stop()})),void o(void 0)}},"Remove"))):r.createElement("div",{className:"card"},r.createElement("h2",{className:"no-select"},r.createElement("i",{className:"material-icons"},"movie"),"No Video Device selected"),r.createElement("p",null,"You need to specify a video device."),r.createElement("div",{className:"actions"},r.createElement(f,{icon:"tv",onClick:function(){M?D(!0):(h.getScreen(!0).then(I),S(!0))}},"Display"),r.createElement(f,{icon:"videocam",onClick:function(){h.getWebcam(!0).then(I),S(!1)}},"Webcam"))),p.map((function(e){return r.createElement("div",{className:"card animated zoomIn fast"},r.createElement("h2",{className:"no-select"},r.createElement("i",{className:"material-icons"},"mic"),"Audio Device"),r.createElement("p",null,e.label),r.createElement("div",{className:"actions"},r.createElement(f,{icon:"delete",onClick:function(){return g(p.filter((function(t){return t.deviceId!==e.deviceId})))}},"Remove")))})),r.createElement(E,{onChange:function(e){return e&&g([].concat(Object(m.a)(p),[y.find((function(t){return t.deviceId===e}))]))},title:"Add audio source",dontSelect:!0,getOptions:Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!0});case 2:return e.next=4,h.getDevices();case 4:return t=e.sent,O(t),e.abrupt("return",t.filter((function(e){return"audioinput"===e.kind})).map((function(e){return{id:e.deviceId,value:e.label,icon:"mic"}})));case 7:case"end":return e.stop()}}),e)})))}),r.createElement("div",{className:"bottom-actions"},r.createElement(f,{icon:"arrow_back",onClick:e.onBack},"Back"),c&&r.createElement(f,{icon:"fiber_manual_record",onClick:Object(d.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==(n=e.startRecording)&&void 0!==n){t.next=4;break}t.next=12;break;case 4:return t.t0=n,t.t1=e,t.t2=c,t.next=9,Promise.all(p.map((function(e){return navigator.mediaDevices.getUserMedia({audio:{deviceId:e.deviceId}})})));case 9:t.t3=t.sent,t.t4={video:t.t2,audio:t.t3},t.t0.call.call(t.t0,t.t1,t.t4);case 12:case"end":return t.stop()}}),t)})))},"Start Recording")))},y=function(e){var t=Object(r.useRef)(new Date),n=Object(r.useRef)(null),a=Object(r.useRef)([]),c=Object(r.useRef)(),o=Object(r.useRef)(!1),i=function(){var n=Object(d.a)(u.a.mark((function n(){var r,i,s;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("Stop"),!c.current||o.current){n.next=8;break}return o.current=!0,n.next=5,c.current.stop();case 5:null===(r=e.onStop)||void 0===r||r.call(e,a.current,(new Date).getTime()-t.current.getTime()),null===(i=e.recordingConfig.video)||void 0===i||i.getTracks().forEach((function(e){return e.stop()})),null===(s=e.recordingConfig.audio)||void 0===s||s.forEach((function(e){return e.getTracks().forEach((function(e){return e.stop()}))}));case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return Object(r.useEffect)((function(){if(n.current&&!o.current){var r;e.recordingConfig.video&&(n.current.srcObject=e.recordingConfig.video,n.current.volume=0,n.current.play());var s=new MediaStream([e.recordingConfig.video.getVideoTracks()[0],null===(r=h.mergeTracks(e.recordingConfig.video,e.recordingConfig.audio))||void 0===r?void 0:r.getAudioTracks()[0]].filter((function(e){return!!e})));c.current=new MediaRecorder(s),c.current.start(3e4),s.getTracks().forEach((function(e){return e.addEventListener("ended",(function(){return i()}))})),c.current.ondataavailable=function(e){return a.current.push(e.data)},t.current=new Date}}),[e.recordingConfig.video,n.current]),r.createElement(v,{title:"Recording...",className:"recording"},e.recordingConfig.video&&r.createElement("div",{className:"video-preview"},r.createElement("video",{ref:n})),r.createElement("div",{className:"card"},r.createElement("h2",{className:"no-select"},r.createElement("i",{className:"material-icons"},"camera_roll"),"Your recording is running"),r.createElement("p",null,"Your specified devices are being recorded."),r.createElement("div",{className:"actions"},r.createElement(f,{icon:"check",onClick:i},"Stop Recording"))))},O=function(e){var t=Object(r.useRef)(null),n=Object(r.useState)(0),a=Object(s.a)(n,2),c=a[0],o=a[1];Object(r.useEffect)((function(){if(t.current){var n=new Blob(e.blobs,{type:"video/webm"});t.current.src=window.URL.createObjectURL(n),t.current.play(),t.current.loop=!0,t.current.controls=!0,o(n.size)}}),[]);var i=c/1024,l="KB";i>1024&&(i/=1024,l="MB"),i>1024&&(i/=1024,l="GB"),i=Math.round(100*i)/100;var u=Math.floor(e.length/1e3%60),d=Math.floor(e.length/1e3/60);return r.createElement(v,{title:"Done!"},r.createElement("div",{className:"video-preview"},r.createElement("video",{ref:t})),r.createElement("p",null,"Your video file is ",r.createElement("b",null,d," minutes and ",u," seconds")," long and takes up ",r.createElement("b",null,i,l)," in space."),r.createElement("p",null,"The file is available as ",r.createElement("b",null,".webm")," video file, which can be opened by web browsers and most video viewers such as VLC."),r.createElement("div",{className:"bottom-actions"},r.createElement(f,{icon:"get_app",onClick:function(){var t=URL.createObjectURL(new Blob(e.blobs,{type:"video/webm"})),n=document.createElement("a");document.body.appendChild(n),n.style.display="none",n.href=t,n.download="recording.webm",n.click(),window.URL.revokeObjectURL(t)}},"Download"),r.createElement(f,{icon:"fiber_manual_record",onClick:e.onRestart},"Record another one")))},j=function(e){var t=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,n="undefined"!==typeof InstallTrigger,a=(/constructor/i.test(window.HTMLElement)||(!window.safari||"undefined"!==typeof safari&&safari.pushNotification).toString(),!!document.documentMode),c=!a&&!!window.StyleMedia,o=!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime);o&&navigator.userAgent.indexOf("Edg"),(o||t)&&window.CSS;return r.createElement(v,{title:"Vileo"},r.createElement("p",null,"Vileo is a simple video recording tool for recording your screen, your webcam or audio devices."),r.createElement("p",null,"It works from within your browser and can be started right away!"),n&&r.createElement("div",{className:"card"},r.createElement("h2",{className:"no-select"},r.createElement("img",{height:"32",width:"32",src:"https://unpkg.com/simple-icons@v2/icons/mozillafirefox.svg",style:{filter:"invert(1)"}}),"\xa0 You're running Firefox!"),r.createElement("p",null,"Recording desktop audio might not be possible here. Try Google Chrome if you need desktop audio.")),c&&r.createElement("div",{className:"card"},r.createElement("h2",{className:"no-select"},r.createElement("img",{height:"32",width:"32",src:"https://unpkg.com/simple-icons@v2/icons/microsoftedge.svg",style:{filter:"invert(1)"}}),"\xa0 You're running Microsoft Edge!"),r.createElement("p",null,"The Recorder might not work on your browser. Try Google Chrome instead.")),a&&r.createElement("div",{className:"card"},r.createElement("h2",{className:"no-select"},r.createElement("img",{height:"32",width:"32",src:"https://unpkg.com/simple-icons@v2/icons/internetexplorer.svg",style:{filter:"invert(1)"}}),"\xa0 You're running Internet Explorer!"),r.createElement("p",null,"The Recorder might not work on your browser. Try Google Chrome instead.")),r.createElement("div",{className:"bottom-actions"},r.createElement(f,{icon:"arrow_forward",onClick:function(){return e.onChangePage(i.Configure)}},"Let's go!")))},N=function(e){var t=Object(r.useState)(i.Welcome),n=Object(s.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)(),l=Object(s.a)(o,2),u=l[0],d=l[1],m=Object(r.useState)(),v=Object(s.a)(m,2),f=v[0],p=v[1];switch(a){case i.Welcome:return r.createElement(j,{onChangePage:c});case i.Configure:return r.createElement(k,{startRecording:function(e){d(e),c(i.RecordingProcess)},onBack:function(){return c(i.Welcome)}});case i.RecordingProcess:return r.createElement(y,{recordingConfig:u,onStop:function(e,t){p([e,t]),c(i.Finished)}});case i.Finished:return r.createElement(O,{blobs:f[0],length:f[1],onRestart:function(){return c(i.Configure)}});default:return r.createElement("div",null,"Content")}},C=n(11),S=function(e){return r.createElement("footer",null,"Vileo ",C.version," -"," ","Made by Lukas Bach."," ",r.createElement("a",{href:"https://lukasbach.com",target:"_blank"},"lukasbach.com")," ",r.createElement("a",{href:"https://github.com/lukasbach/vileo",target:"_blank",rel:"noopener noreferrer"},"GitHub Repo"))};o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement("div",{className:"app-container"},a.a.createElement(N,null),a.a.createElement(S,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[13,1,2]]]);
//# sourceMappingURL=main.af841d71.chunk.js.map